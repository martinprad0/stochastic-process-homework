\section*{Exercise 2}
Consider the following 6 vertex graph and a random walk over these states

\begin{figure}[H]
    \centering
    \input{../figures/figure1}
\end{figure}

\begin{enumerate}
    \item[(a)] Show that this random walk is irreducible
    \item[(b)] Build the linear system for the arrival times for each state and solve them.
    \item[(c)] Infer the invariant measure.
    \item[(d)] If $X_0 = 0$, does the marginal law converges to the invariant measure?  
\end{enumerate}

\subsection*{Solution (a)}

The transition matrix is

\[ \Pi = \left[\begin{matrix}0 & \frac{1}{2} & 0 & \frac{1}{2} & 0 & 0\\0 & 0 & 1 & 0 & 0 & 0\\1 & 0 & 0 & 0 & 0 & 0\\0 & \frac{1}{3} & \frac{1}{3} & 0 & \frac{1}{3} & 0\\0 & 0 & 0 & 0 & 0 & 1\\0 & 0 & 0 & 1 & 0 & 0\end{matrix}\right]
\]

If one follows the path:

\[ 1\to 2\to 0 \to 3 \to 4 \to 5 \to 3 \to 1. \]

It's possible to create a path from $i$ to $j$ in less than 7 steps, for any $i,j$. Furthermore, the system is also strongly irreducible, because the first $m$ for which $\Pi^m(i,j) > 0$ for every $i,j\in\S$ is $m = 11$:

\[ \arraycolsep=3.4pt\def\arraystretch{1.2}
\Pi^{10} = \left[\begin{matrix}\frac{1}{3} & \frac{43}{216} & \frac{2}{27} & \frac{1}{3} & \frac{1}{216} & \frac{1}{18}\\\frac{1}{36} & \frac{5}{18} & \frac{7}{18} & \frac{1}{6} & \frac{5}{36} & 0\\\frac{7}{18} & \frac{5}{72} & \frac{1}{3} & \frac{1}{72} & \frac{1}{18} & \frac{5}{36}\\\frac{13}{108} & \frac{5}{18} & \frac{25}{108} & \frac{5}{18} & \frac{1}{12} & \frac{1}{108}\\\frac{5}{18} & \frac{1}{9} & \frac{7}{18} & \frac{1}{36} & \frac{1}{12} & \frac{1}{9}\\\frac{7}{18} & \frac{4}{27} & \frac{13}{108} & \frac{1}{4} & \frac{1}{108} & \frac{1}{12}\end{matrix}\right] \]

\[ \arraycolsep=3.4pt\def\arraystretch{1.2}
\Pi^{11} = \left[\begin{matrix}\frac{2}{27} & \frac{5}{18} & \frac{67}{216} & \frac{2}{9} & \frac{1}{9} & \frac{1}{216}\\\frac{7}{18} & \frac{5}{72} & \frac{1}{3} & \frac{1}{72} & \frac{1}{18} & \frac{5}{36}\\\frac{1}{3} & \frac{43}{216} & \frac{2}{27} & \frac{1}{3} & \frac{1}{216} & \frac{1}{18}\\\frac{25}{108} & \frac{11}{72} & \frac{10}{27} & \frac{5}{72} & \frac{5}{54} & \frac{1}{12}\\\frac{7}{18} & \frac{4}{27} & \frac{13}{108} & \frac{1}{4} & \frac{1}{108} & \frac{1}{12}\\\frac{13}{108} & \frac{5}{18} & \frac{25}{108} & \frac{5}{18} & \frac{1}{12} & \frac{1}{108}\end{matrix}\right] \]

\subsection*{Solution (b)}

For this part, we define a matrix $\Pi^{(j)}$ which is the matrix $\Pi$ but the $j$-th column is only 0's. This way, we obtain
\[ {(\Pi^{(j)} \mu_j )}_i = \sum_{l \neq j} \Pi(i,j) \mu_j(l) \]
The linear system we are going to solve is 
\[ (I-\Pi^{(j)})\mu_j = \1_{6}. \]
By doing this, we obtain
\[ 
\mu_0 = \left[\begin{matrix}4\\2\\1\\4\\6\\5\end{matrix}\right],\;
\mu_1 = \left[\begin{matrix}\frac{10}{3}\\\frac{16}{3}\\\frac{13}{3}\\\frac{14}{3}\\\frac{20}{3}\\\frac{17}{3}\end{matrix}\right],\;
\mu_2 = \left[\begin{matrix}3\\1\\4\\3\\5\\4\end{matrix}\right],\;
\mu_3 = \left[\begin{matrix}4\\6\\5\\\frac{16}{3}\\2\\1\end{matrix}\right],\;
\mu_4 = \left[\begin{matrix}18\\20\\19\\14\\16\\15\end{matrix}\right],\;
\mu_5 = \left[\begin{matrix}19\\21\\20\\15\\1\\16\end{matrix}\right]. \]

It's clear that in a good result, $\mu_3(4) = 2$ because from 4 you can only go to 3 in exactly 2 steps with probability 1. In a similar fashion,
\[ \mu_0(2) = \mu_2(1) = \mu_3(5) =\mu_5(4) = 1, \]
because in those cases there exists an arrow with probability 1 of transitioning from $i$ to $j$.

\subsection*{Solution (c)}

The invariant $\pi$ is the solution to the system
\[ \mu\Pi = \mu,\hspace*{1em} \sum_{i\in\S}\mu_i = 1,\hspace*{1em} \mu_i > 0,\;\forall i\in\S. \]

This solution is
\[ \pi = \left[\begin{matrix}\frac{1}{4} & \frac{3}{16} & \frac{1}{4} & \frac{3}{16} & \frac{1}{16} & \frac{1}{16}\end{matrix}\right] \]

It is a probability measure and it satisfies $\pi \Pi = \pi$.

\subsection*{Solution (d)}

According to the ergodic theorem, for irreducible Markov chains, let $m$ such that $\Pi^m(i,j) > 0$ for every $i,j\in\S$ and let
\[ \alpha = \sum_{j} \inf_{i}\Pi^m(i,j) \]
Then, for every measure $\mu \in \mathcal{P}(\S)$
\[ \sup_{A\subset \S}|\mu\Pi^n(A)-\pi(A)| \leq {(1-\alpha)}^{\floor{\frac{n}{m}}} . \]

Therefore, if $\mu = \left[\begin{matrix}1 & 0 & 0 & 0 & 0 & 0\end{matrix}\right]$, $\mu\Pi^n$ will converge to $\pi$ at an exponential rat because we proved that the process is strongly irreducible.
